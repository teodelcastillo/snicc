var actions_html_ingei = {
    "Energía limpia en emisiones de GEI": "<div class=\"main monitoreo energia\" style=\"\"><div class=\"content content_energia\"><div class=\"select updownarrow generacion-a-gran-escala activo\"><div class=\"categorias\" style=\"display:block\"><h4 class=\"categoria generacion-fuentes-renovables\"><strong>TE-15:</strong>Implementar proyectos de generación eléctrica a partir de fuentes renovables no convencionales conectadas a la red<span class=\"plusminus\"></span></h4><div class=\"labels\" style=\"padding-top:0;display:none\"><h5 class=\"categoria nivel_cuatro_categoria_energia activo\">Todas las fuentes<span class=\"plusminus\"></span></h5><div class=\"labels\" style=\"padding-top:0;display:block\"><p class=\"categoria activo\">Generación de electricidad</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px;display:block\"><label class=\"sec monitoreo_select\" data-monitoreo=\"5\" for=\"dis_sec_renovable_1\"><input type=\"radio\" id=\"dis_sec_renovable_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label><label class=\"sec monitoreo_select\" data-monitoreo=\"6\" for=\"dis_sec_renovable_2\"><input type=\"radio\" id=\"dis_sec_renovable_2\" name=\"dis_sector_id\" value=\"1\"> Gráfico de anillo</label></div><p class=\"categoria\">Capacidad instalada</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"7\" for=\"dis_sec_renovable_3\"><input type=\"radio\" id=\"dis_sec_renovable_3\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label><label class=\"sec monitoreo_select\" data-monitoreo=\"8\" for=\"dis_sec_renovable_4\"><input type=\"radio\" id=\"dis_sec_renovable_4\" name=\"dis_sector_id\" value=\"1\"> Gráfico de anillo</label></div><p class=\"categoria\">Participación de la generación de electricidad</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"9\" for=\"dis_sec_renovable_5\"><input type=\"radio\" id=\"dis_sec_renovable_5\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label><label class=\"sec monitoreo_select\" data-monitoreo=\"10\" for=\"dis_sec_renovable_6\"><input type=\"radio\" id=\"dis_sec_renovable_6\" name=\"dis_sector_id\" value=\"1\"> Gráfico de torta</label></div></div><h5 class=\"categoria nivel_cuatro_categoria_energia\">Por tipo de fuente<span class=\"plusminus\"></span></h5><div class=\"labels\"><p class=\"categoria\">Eólica</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"11\" for=\"dis_sec_renovable_1\"><input type=\"radio\" id=\"dis_sec_renovable_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Generación de electricidad</label><label class=\"sec monitoreo_select\" data-monitoreo=\"12\" for=\"dis_sec_renovable_2\"><input type=\"radio\" id=\"dis_sec_renovable_2\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div><p class=\"categoria\">Solar</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"13\" for=\"dis_sec_renovable_1\"><input type=\"radio\" id=\"dis_sec_renovable_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Generación de electricidad</label><label class=\"sec monitoreo_select\" data-monitoreo=\"14\" for=\"dis_sec_renovable_2\"><input type=\"radio\" id=\"dis_sec_renovable_2\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div><p class=\"categoria\">Pequeños Aprovechamientos Hidroeléctricos (&lt;50 MW)</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"15\" for=\"dis_sec_renovable_1\"><input type=\"radio\" id=\"dis_sec_renovable_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Generación de electricidad</label><label class=\"sec monitoreo_select\" data-monitoreo=\"16\" for=\"dis_sec_renovable_2\"><input type=\"radio\" id=\"dis_sec_renovable_2\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div><p class=\"categoria\">Biomasa</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"17\" for=\"dis_sec_renovable_1\"><input type=\"radio\" id=\"dis_sec_renovable_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Generación de electricidad</label><label class=\"sec monitoreo_select\" data-monitoreo=\"18\" for=\"dis_sec_renovable_2\"><input type=\"radio\" id=\"dis_sec_renovable_2\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div><p class=\"categoria\">Biogás</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"19\" for=\"dis_sec_renovable_1\"><input type=\"radio\" id=\"dis_sec_renovable_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Generación de electricidad</label><label class=\"sec monitoreo_select\" data-monitoreo=\"20\" for=\"dis_sec_renovable_2\"><input type=\"radio\" id=\"dis_sec_renovable_2\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div></div></div><h4 class=\"categoria generacion-nuclear\"><strong>TE-16:</strong>Potenciar la generación nuclear<span class=\"plusminus\"></span></h4><div class=\"labels\" style=\"display:none\"><label class=\"sec monitoreo_select activo\" data-monitoreo=\"1\" for=\"dis_sec_all_nuclear\"><input type=\"radio\" id=\"dis_sec_all_nuclear\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Generación de electricidad</label><label class=\"sec monitoreo_select\" data-monitoreo=\"2\" for=\"dis_sec_1_nuclear\"><input type=\"radio\" id=\"dis_sec_1_nuclear\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div><h4 class=\"categoria generacion-hidroelectrica\"><strong>TE-17:</strong>Potenciar la generación hidroeléctrica considerando los escenarios futuros de cambio climático en las variables de diseño<span class=\"plusminus\"></span></h4><div class=\"labels\"><label class=\"sec monitoreo_select\" data-monitoreo=\"3\" for=\"dis_sec_all_hidro\"><input type=\"radio\" id=\"dis_sec_all_hidro\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Generación de electricidad</label><label class=\"sec monitoreo_select\" data-monitoreo=\"4\" for=\"dis_sec_1_hidro\"><input type=\"radio\" id=\"dis_sec_1_hidro\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div><h4 class=\"categoria\"><strong>TE-18:</strong>Promover la generación eléctrica distribuida de energía renovable integrada a la red eléctrica pública<span class=\"plusminus\"></span></h4><div class=\"labels\"><label class=\"sec monitoreo_select\" data-monitoreo=\"41\" for=\"dis_sec_1_t18\"><input type=\"radio\" id=\"dis_sec_1_t18\" name=\"dis_sector_id\" value=\"1\"> Capacidad instalada</label></div><h4 class=\"categoria corte-biocombustible\"><strong>TE-19:</strong>Promover el corte con biocombustibles<span class=\"plusminus\"></span></h4><div class=\"labels\" style=\"padding-top:0\"><p class=\"categoria\">Biodiésel</p><div class=\"labels\" style=\"padding-top:0\"><label class=\"sec monitoreo_select\" data-monitoreo=\"21\" for=\"biod_sec_1\"><input type=\"radio\" id=\"biod_sec_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Corte de biodiésel en gasoil</label><label class=\"sec monitoreo_select\" data-monitoreo=\"22\" for=\"biod_sec_2\"><input type=\"radio\" id=\"biod_sec_2\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Volumen de biodiésel vendido</label></div><p class=\"categoria\">Bioetanol</p><div class=\"labels\" style=\"padding-top:0\"><label class=\"sec monitoreo_select\" data-monitoreo=\"23\" for=\"bioe_sec_1\"><input type=\"radio\" id=\"bioe_sec_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Corte de bioetanol en nafta</label><label class=\"sec monitoreo_select\" data-monitoreo=\"24\" for=\"bioe_sec_2\"><input type=\"radio\" id=\"bioe_sec_2\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Volumen de bioetanol vendido</label></div></div><h4 class=\"categoria corte-biocombustible\">Generación eléctrica de centrales “no fósiles\" conectadas a la red<span class=\"plusminus\"></span></h4><div class=\"labels\" style=\"padding-top:0\"><p class=\"categoria\">Generación de electricidad</p><div class=\"labels\" style=\"padding:0\"><label class=\"sec monitoreo_select\" data-monitoreo=\"25\" for=\"gen_conect_1\"><input type=\"radio\" id=\"gen_conect_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label><label class=\"sec monitoreo_select\" data-monitoreo=\"26\" for=\"gen_conect_2\"><input type=\"radio\" id=\"gen_conect_2\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de anillo</label></div><p class=\"categoria\">Capacidad instalada</p><div class=\"labels\" style=\"padding:0\"><label class=\"sec monitoreo_select\" data-monitoreo=\"27\" for=\"gen_conect_3\"><input type=\"radio\" id=\"gen_conect_3\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label><label class=\"sec monitoreo_select\" data-monitoreo=\"28\" for=\"gen_conect_4\"><input type=\"radio\" id=\"gen_conect_4\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de anillo</label></div><p class=\"categoria\">Participación de la generación de electricidad</p><div class=\"labels\" style=\"padding:0\"><label class=\"sec monitoreo_select\" data-monitoreo=\"29\" for=\"gen_conect_5\"><input type=\"radio\" id=\"gen_conect_5\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label><label class=\"sec monitoreo_select\" data-monitoreo=\"30\" for=\"gen_conect_6\"><input type=\"radio\" id=\"gen_conect_6\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de torta</label></div></div></div></div><div class=\"download_box_row\"><div class=\"download_box\"><h4 class=\"title_metodologico\">INFORME METODOLÓGICO</h4><a href=\"https://inventariogei.ambiente.gob.ar/files/monitoreo-energia-informe-metodologico.pdf\" target=\"_blank\"><button class=\"btn_metodologico energia\">PDF</button></a></div><div class=\"clear\"></div></div></div></div>",
    "Desarrollo de la movilidad sostenible a nivel urbano": "<div class=\"main monitoreo transporte\"><div class=\"content content_movilidad\"><div class=\"select updownarrow activo\"><div class=\"categorias\" style=\"display:block\"><h4 class=\"categoria implementacion-metrobuses\"><strong>MS-06:</strong>Apoyar el desarrollo de sistemas de movilidad urbana sostenible<span class=\"plusminus\"></span></h4><div class=\"labels\" style=\"display:none\"><label class=\"sec monitoreo_select\" data-monitoreo=\"33\" for=\"imp_metro_1\"><input type=\"radio\" id=\"imp_metro_1\" name=\"imp_metro_id\" value=\"1\" checked=\"checked\"> Cantidad de kilómetros de la red en uso</label><label class=\"sec monitoreo_select\" data-monitoreo=\"34\" for=\"imp_metro_2\"><input type=\"radio\" id=\"imp_metro_2\" name=\"imp_metro_id\" value=\"2\"> Cantidad de corredores en uso</label></div></div></div><div class=\"download_box_row\"><div class=\"download_box\"><h4 class=\"title_metodologico\">INFORME METODOLÓGICO</h4><a href=\"https://inventariogei.ambiente.gob.ar/files/monitoreo-transporte-informe-metodologico.pdf\" target=\"_blank\"><button class=\"btn_metodologico movilidad\">PDF</button></a></div><div class=\"clear\"></div></div></div></div>",
    "Fortalecimiento del sistema ferroviario": "<div class=\"main monitoreo transporte\"><div class=\"content content_movilidad\"><div class=\"select updownarrow activo\"><div class=\"categorias\" style=\"display:block\"><h4 class=\"categoria desarrollo-expreso-regionales\"><strong>MS-09:</strong>Jerarquizar los servicios ferroviarios de transporte de pasajeros/as<span class=\"plusminus\"></span></h4><div class=\"labels\" style=\"padding-top:0\"><p class=\"categoria\">Cambio modal</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"31\" for=\"transporte_1\"><input type=\"radio\" id=\"transporte_1\" name=\"transporte_id\" value=\"all\" checked=\"checked\"> Cantidad de pasajeros por línea de ferrocarril del AMBA</label><label class=\"sec monitoreo_select\" data-monitoreo=\"39\" for=\"transporte_inter_2\"><input type=\"radio\" id=\"transporte_inter_2\" name=\"transporte_inter_id\" value=\"1\" checked=\"checked\"> Cantidad de pasajeros transportados en el ferrocarril Buenos Aires – Rosario</label><label class=\"sec monitoreo_select\" data-monitoreo=\"40\" for=\"transporte_inter_3\"><input type=\"radio\" id=\"transporte_inter_3\" name=\"transporte_inter_id\" value=\"2\"> Cantidad de pasajeros transportados en el ferrocarril Buenos Aires – Mar del Plata</label></div><p class=\"categoria\">Electrificación</p><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"32\" for=\"transporte_3\"><input type=\"radio\" id=\"transporte_3\" name=\"transporte_id\" value=\"all\" checked=\"checked\"> Proporción de kilómetros recorridos por trenes eléctricos de la línea Roca</label></div></div></div></div><div class=\"download_box_row\"><div class=\"download_box\"><h4 class=\"title_metodologico\">INFORME METODOLÓGICO</h4><a href=\"https://inventariogei.ambiente.gob.ar/files/monitoreo-transporte-informe-metodologico.pdf\" target=\"_blank\"><button class=\"btn_metodologico movilidad\">PDF</button></a></div><div class=\"clear\"></div></div></div></div>",
    "Reducción de emisiones de la aviación argentina": "<div class=\"main monitoreo transporte\"><div class=\"content content_movilidad\"><div class=\"select updownarrow activo\"><div class=\"categorias\" style=\"display:block\"><h4 class=\"categoria mejoras-aeronavegacion\"><strong>MS-12:</strong>Reducir las emisiones de la aviación argentina<span class=\"plusminus\"></span></h4><div class=\"labels\" style=\"padding-top:0;padding-left:25px\"><label class=\"sec monitoreo_select\" data-monitoreo=\"38\" for=\"transporte_inter_1\"><input type=\"radio\" id=\"transporte_inter_1\" name=\"transporte_id\" value=\"1\" checked=\"checked\"> Consumo de aerokerosene por mil pasajeros en aviones de cabotaje</label></div></div></div><div class=\"download_box_row\"><div class=\"download_box\"><h4 class=\"title_metodologico\">INFORME METODOLÓGICO</h4><a href=\"https://inventariogei.ambiente.gob.ar/files/monitoreo-transporte-informe-metodologico.pdf\" target=\"_blank\"><button class=\"btn_metodologico movilidad\">PDF</button></a></div><div class=\"clear\"></div></div></div></div>",
    "Ordenamiento ambiental del territorio": "<div class=\"main monitoreo bosques\" style=\"\"><div class=\"content content_biodiversidad\"><div class=\"select updownarrow activo\"><h3 class=\"slider deforestacion-evitada\">Ordenamiento ambiental del territorio</h3><div class=\"categorias\" style=\"display:block\"><h4 class=\"categoria\"><strong>CB-16:</strong>Evitar la deforestación ilegal y reducir la deforestación legal<span class=\"plusminus\"></span></h4><div class=\"labels\"><h5 class=\"categoria nivel_cuatro_categoria_biodiversidad\">Deforestación evitada de los bosques nativos<span class=\"plusminus\"></span></h5><div class=\"labels\"><p class=\"categoria\">Diferencia entre la deforestación y el nivel de referencia</p><div class=\"labels\"><label class=\"sec monitoreo_select\" data-monitoreo=\"37\" for=\"gen_conect_2\"><input type=\"radio\" id=\"gen_conect_2\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label></div></div><h5 class=\"categoria nivel_cuatro_categoria_biodiversidad\">Planes de manejo y conservación de bosques nativos<br><span class=\"nivel_cuatro_categoria_biodiversidad_parentesis\">(Manejo sostenible, conservación, restauración y recuperación de bosques nativos, y prevención de incendios forestales)</span><span class=\"plusminus\"></span></h5><div class=\"labels\"><p class=\"categoria\">Superficie bajo planes</p><div class=\"labels\"><label class=\"sec monitoreo_select\" data-monitoreo=\"36\" for=\"gen_conect_1\"><input type=\"radio\" id=\"gen_conect_1\" name=\"dis_sector_id\" value=\"all\" checked=\"checked\"> Gráfico de barras</label></div></div></div></div></div><div class=\"download_box_row\"><div class=\"download_box\"><h4 class=\"title_metodologico\">INFORME METODOLÓGICO</h4><a href=\"https://inventariogei.ambiente.gob.ar/files/monitoreo-bosques-informe-metodologico.pdf\" target=\"_blank\"><button class=\"btn_metodologico biodiversidad\">PDF</button></a></div><div class=\"clear\"></div></div></div></div>"
};

var f = "monitoreo";
var sector_id = "all";
var join_todos = true;
var sector_nombre = "all";
var subactividad_nombre = "all";

var chart,
  indicador_id,
  ano,
  dis_sector_id,
  evo_sector_id,
  last_f,
  last_evo_sector_id;

var arrSectores = {};
arrSectores[1] =
  "Agricultura, ganadería, silvicultura y otros usos de la tierra";
arrSectores[2] = "Energía";
arrSectores[3] = "Procesos industriales y uso de productos";
arrSectores[4] = "Residuos";

var arrSectoresNombre = {};
arrSectoresNombre[
  "Agricultura, ganadería, silvicultura y otros usos de la tierra"
] = 1;
arrSectoresNombre["Energía"] = 2;
arrSectoresNombre["Procesos industriales y uso de productos"] = 3;
arrSectoresNombre["Residuos"] = 4;

var arrSubActividad = {};
arrSubActividad["Aguas residuales domésticas"] = 26;
arrSubActividad["Aguas residuales industriales"] = 27;
arrSubActividad["Cambio de carbono en suelos"] = 5;
arrSubActividad["Eliminación de residuos sólidos"] = 28;
arrSubActividad["Emisiones fugitivas"] = 13;
arrSubActividad["Excretas en pasturas"] = 4;
arrSubActividad["Fermentación entérica"] = 2;
arrSubActividad["Gestión de estiércol"] = 3;
arrSubActividad["Incineración de residuos"] = 29;
arrSubActividad["Industrias de la energía"] = 12;
arrSubActividad["Industrias manufactureras y de la construcción"] = 11;
arrSubActividad["Otros industria de los minerales"] = 14;
arrSubActividad["Otros industrias de los metales"] = 15;
arrSubActividad["Otros sectores"] = 9;
arrSubActividad["Pastizales"] = 8;
arrSubActividad["Producción de ácido nítrico"] = 16;
arrSubActividad["Producción de aluminio"] = 17;
arrSubActividad["Producción de amoníaco"] = 18;
arrSubActividad["Producción de cal"] = 19;
arrSubActividad["Producción de carburo"] = 20;
arrSubActividad["Producción de cemento"] = 21;
arrSubActividad["Producción de ceniza de sosa"] = 22;
arrSubActividad["Producción de hierro y acero"] = 23;
arrSubActividad["Producción fluoroquímica"] = 25;
arrSubActividad["Producción petroquímica y de negro de humo"] = 24;
arrSubActividad["Tierras de cultivo"] = 6;
arrSubActividad["Tierras forestales"] = 7;
arrSubActividad["Transporte"] = 10;
arrSubActividad["Uso de suelos"] = 1;

function round(value, amount = 2) {
  if (typeof value == "number") {
    return value.toFixed(amount).replace(".", ",");
  }

  if (typeof value == "string") {
    return parseFloat(value.replace(",", "."))
      .toFixed(amount)
      .replace(".", ",");
  }
}

function toComma(value) {
  return String(value).replace(".", ",");
}

function numberWithCommas(x) {
  return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}

function correctDecimals(d, cant) {
  return d.toFixed(cant);
}

$(document).ready(function () {
  // MONITOREO
  $("#nav .nav_monitoreo .monitoreo_select").click(function () {
    $("#nav .nav_monitoreo .monitoreo_select").removeClass("activo");
    $(this).addClass("activo");

    f = "monitoreo";
    monitoreo_id = $(this).attr("data-monitoreo");

    ver_resultado();
    return false;
  });


  $(".nav_monitoreo .categorias h4").click(function () {
    if ($(this).next(".labels").is(":hidden")) {
      $(".nav_monitoreo .categorias .labels").not(this).slideUp();
      $(".nav_monitoreo .categorias h4").not(this).removeClass("activo");
    }

    $(this)
      .next(".labels")
      .slideToggle(function () {
        if ($(this).is(":visible")) {
          $(this).prev("h4.categoria").addClass("activo");
        } else {
          $(this).prev("h4.categoria").removeClass("activo");
        }
      });
  });

  $(".nav_monitoreo .categorias .labels h5.categoria").click(function () {
    if ($(this).next(".labels").is(":hidden")) {
      $("h5.categoria").next(".labels").not($(this).next(".labels")).slideUp();
      $("h5.categoria").not(this).removeClass("activo");
    }

    $(this)
      .next(".labels")
      .slideToggle(function () {
        if ($(this).is(":visible")) {
          $(this).prev("h5.categoria").addClass("activo");
        } else {
          $(this).prev("h5.categoria").removeClass("activo");
        }
      });
  });

  $("p.categoria").click(function () {
    if ($(this).next(".labels").is(":hidden")) {
      $("p.categoria").next(".labels").not($(this).next(".labels")).slideUp();
      $("p.categoria").not(this).removeClass("activo");
    }

    $(this)
      .next(".labels")
      .slideToggle(function () {
        if ($(this).is(":visible")) {
          $(this).prev("p.categoria").addClass("activo");
        } else {
          $(this).prev("p.categoria").removeClass("activo");
        }
      });
  });

  // RADIO BUTTONS
  $("#nav").on("click", "label.sec", function () {
    $("#nav label.sec").removeClass("activo");
    $(this).addClass("activo");
  });
});

function ver_resultado() {
  // DATOS DEL FILTRO
  ano = $("#select_ano").val();
  dis_sector_id = $("input[type=radio][name=dis_sector_id]")
    .filter(":checked")
    .val();

  $("#chart").show();
  graficar();

  $(".main.select.tipo_grafico").css("display", "none");


  // Ocultar gráficos de anillo
  $("#chart2").remove(); //2016
  $("#chart3").remove(); //2017
  $("#chart4").remove(); //2018
  $("#chart5").remove(); //2019
  $("#chart6").remove(); //2020
  $(".fecha").remove();
  $("#chart").css("width", "100%");
  $("#chart").css("margin", "0");
  /*$("#chart").css("display", "block");*/
  $("#chart").css("padding", "0");
  $("#body .content").css("text-align", "left");
  $("#chart_custom_legend").html("");
  $("#chart_custom_legend").hide();
}

function get_chart_width() {
  var width = $("#body .content").width();
  return width;
}

function get_chart_height() {
  var height =
    $(document).height() -
    $("footer").height() -
    $("footer").height() -
    $("#body .info").height() * 2 - 17 - 17 - 50;
  var exceso = 0;
  if (height > 600) {
    exceso = height - 600;
    height = 600;
  }
  if (exceso > 0) {
    $("#chart").css({ marginTop: exceso / 2 + "px" });
  }
  height = height < 400 ? 400 : height;
  return height;
}

function graficar() {
  $("#unidad_de_medida").hide();
  $("#chart_unidad").html("MtCO₂e");
  $("#chart_descripcion").hide();

  /*if (f == "monitoreo") {
    $("#monitor_title_anio").css("display", "none");
    $("#box_chart_sector").hide();
  }*/

  var char_height = get_chart_height();
  //var char_width = get_chart_width();

  if (f == "monitoreo") {
    monitoreo_file = "/static/main/json/" + f + "_" + monitoreo_id + ".json";

    d3.json(monitoreo_file, function (error, data) {
      $("#chart_title").show();
      $(".info .ley").hide();
      if (
        data.titulo ==
          "PROPORCIÓN DE KILÓMETROS RECORRIDOS POR TRENES ELÉCTRICOS" ||
        data.titulo == "AVANCE DE LA OBRA" ||
        data.titulo == "PARTICIPACIÓN DE LA GENERACIÓN DE ELECTRICIDAD" ||
        data.titulo == "CORTE DE BIODIÉSEL EN GASOIL" ||
        data.titulo == "CORTE DE BIOETANOL EN NAFTA"
      ) {
        var titulo = data.titulo + " (" + data.unidad + ")";
        $("#chart_title").html(titulo);
      } else {
        $("#chart_title").html(data.titulo);
      }

      $("#chart_descripcion").show().html(data.descripcion);
      //$("#body > .content.nomonitoreo").show();

      $("#chart2").remove();
      $("#chart3").remove();
      $("#chart4").remove();
      $("#chart5").remove();
      $("#chart6").remove();

      $(".fecha").remove();
      $("#chart").css("width", "100%");
      $("#chart").css("margin", "0");
      $("#chart").css("display", "block");
      $("#chart").css("padding", "0");
      $("#body .content").css("text-align", "left");
      $("#chart_custom_legend").hide();

      if (
        monitoreo_id == 1 ||
        monitoreo_id == 2 ||
        monitoreo_id == 3 ||
        monitoreo_id == 4 ||
        monitoreo_id == 9 ||
        monitoreo_id == 11 ||
        monitoreo_id == 12 ||
        monitoreo_id == 13 ||
        monitoreo_id == 14 ||
        monitoreo_id == 15 ||
        monitoreo_id == 16 ||
        monitoreo_id == 17 ||
        monitoreo_id == 18 ||
        monitoreo_id == 19 ||
        monitoreo_id == 20 ||
        monitoreo_id == 22 ||
        monitoreo_id == 24 ||
        monitoreo_id == 41 // TODO:prueba
      ) {
        $(".ley").css("display", "block");
        $("#chart_unidad").html(data.unidad);
        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    // TODO: Cuando es 0 no lo muestra en el gráfico retornando un string vacio. Probar funcionamiento
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return numberWithCommas(
                      toComma(correctDecimals(d, data.cantDecimales))
                    );
                  } else {
                    return numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#EE4788"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR"); // devuelve numero sin decimales y con separación de miles
              },
            },

            contents: function (
              d,
              defaultTitleFormat,
              defaultValueFormat,
              color
            ) {
              var $$ = this,
                config = $$.config,
                titleFormat = config.tooltip_format_title || defaultTitleFormat,
                nameFormat =
                  config.tooltip_format_name ||
                  function (name) {
                    return name;
                  },
                valueFormat = config.tooltip_format_value || defaultValueFormat,
                text,
                i,
                title,
                value,
                name,
                bgcolor;
              for (i = 0; i < d.length; i++) {
                if (!(d[i] && (d[i].value || d[i].value === 0))) {
                  continue;
                }

                if (!text) {
                  title = titleFormat ? titleFormat(d[i].x) : d[i].x;
                  text =
                    "<table class='" +
                    $$.CLASS.tooltip +
                    "'>" +
                    (title || title === 0
                      ? "<tr><th colspan='2'>" + title + "</th></tr>"
                      : "");
                }

                name = nameFormat(d[i].name);
                value = valueFormat(
                  d[i].value,
                  d[i].ratio,
                  d[i].id,
                  d[i].index
                );
                bgcolor = $$.levelColor
                  ? $$.levelColor(d[i].value)
                  : color(d[i].id);

                text +=
                  "<tr class='" + $$.CLASS.tooltipName + "-" + d[i].id + "'>";
                text +=
                  "<td class='name'><span style='background-color:" +
                  bgcolor +
                  "'></span>" +
                  name +
                  "</td>";
                text += "<td class='value'>" + value + "</td>";
                text += "</tr>";
              }
              return text + "</table>";
            },
          },
        });

        if (
          monitoreo_id == 1 ||
          monitoreo_id == 2 ||
          monitoreo_id == 3 ||
          monitoreo_id == 4 ||
          monitoreo_id == 9 ||
          monitoreo_id == 11 ||
          monitoreo_id == 12 ||
          monitoreo_id == 13 ||
          monitoreo_id == 14 ||
          monitoreo_id == 15 ||
          monitoreo_id == 16 ||
          monitoreo_id == 17 ||
          monitoreo_id == 18 ||
          monitoreo_id == 19 ||
          monitoreo_id == 20 ||
          monitoreo_id == 21 ||
          monitoreo_id == 22 ||
          monitoreo_id == 23 ||
          monitoreo_id == 24 ||
          monitoreo_id == 29
        ) {
          $(".c3-axis.c3-axis-y .tick tspan").first().html("");
        }
      }
      if (monitoreo_id == 9 || monitoreo_id == 29) {
        $(".ley").css("display", "block");
        $("#chart_unidad").html(data.unidad);
        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    //TODO: Oculta el 0 en los gráficos de barra. Probar funcionamiento
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return numberWithCommas(
                      toComma(correctDecimals(d, data.cantDecimales))
                    );
                  } else {
                    return numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#EE4788"],
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
      }
      if (monitoreo_id == 21 || monitoreo_id == 23) {
        $(".ley").css("display", "block"); // Muestra unidad de medida título
        $("#chart_title").html(data.titulo); //TODO:Muestra el titulo desde el JSON. Probar funcionamiento
        $("#chart_unidad").html(data.unidad);
        $("#unidad_de_medida").show();
        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    //TODO: Oculta el 0 en el gráfico. Probar funcionamiento
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return d; //numberWithCommas(toComma(correctDecimals(d,data.cantDecimales)));
                  } else {
                    return d; //numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#EE4788"],
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value);

                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
      }

      if (monitoreo_id == 35) {
        $(".ley").css("display", "none");

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (data.cantDecimales >= 1) {
                    return d;
                  } else {
                    return numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#4f81bd"],
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = value;

                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
      }
      if (monitoreo_id == 38) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    //TODO: Oculta el 0 en los gráficos de barra. Probar funcionamiento
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return d;
                  } else {
                    return numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#D177B0"],
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = value;

                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
      }

      if (monitoreo_id == 18 || monitoreo_id == 14) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    //TODO: No muestra el 0 en los gráficos. Probar funcionamiento
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return d;
                  } else {
                    return numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#EE4788"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR"); // devuelve numero sin decimales y con separación de miles
              },
            },
          },
        });
      }

      if (monitoreo_id == 5 || monitoreo_id == 7) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [
              data.valores1,
              data.valores2,
              data.valores3,
              data.valores4,
              data.valores5,
              data.anio,
            ],
            type: "bar",
            groups: [["Biogás", "Biomasa", "PAH", "Solar", "Eólica"]],
            order: null,
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    //TODO: No mostrar 0 en el gráfico. Probar funcionamiento
                    return "";
                  }
                  return numberWithCommas(toComma(correctDecimals(d)));
                },
              },
            },
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0", "#FCE4ED"],
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // TODO: Probar funcionamiento
                // value = Math.round(value * 100) / 100;
                return value.toLocaleString("es-AR", {
                  maximumFractionDigits: 0,
                });
              },
            },
          },
        });
      }
      //nuevo para monitoreo 36 superficie bajo planes//
      if (monitoreo_id == 36) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores1, data.valores2, data.valores3, data.anio],
            type: "bar",
            groups: [
              [
                "Planes de manejo",
                "Planes de conservación",
                "Planes de manejo y conservación",
              ],
            ],
            order: null,
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    //TODO: Oculta el 0 en los gráficos de barra. Probar funcionamiento
                    return "";
                  }
                  return numberWithCommas(toComma(correctDecimals(d)));
                },
              },
            },
          },

          color: {
            pattern: ["#BFD730", "#585961", "#DFEB97"],
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                return numberWithCommas(toComma(value.toFixed()));
              },
            },
          },
        });
      }

      //  fin //

      //nuevo para monitoreo 37 deforestación evitada//
      if (monitoreo_id == 37) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },
          data: {
            x: "x",
            columns: [
              data.valores1,
              data.valores2,
              data.valores3,
              data.valores4,
              data.anio,
            ],
            type: "bar",
            groups: [
              [
                "Parque Chaqueño",
                "Selva Tucumano-Boliviana",
                "Selva Paranaense",
                "Espinal",
              ],
            ],
            order: null,
          },
          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },
          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              min: data.min,
              padding: { bottom: 0 },
              //min: 0,
              tick: {
                format: function (d) {
                  return numberWithCommas(toComma(correctDecimals(d)));
                },
              },
            },
          },
          grid: {
            y: {
              lines: [{ value: 0, class: "line_deforestacion" }],
            },
          },
          color: {
            pattern: ["#BFD730", "#585961", "#DFEB97", "#B3B0B0", "#F2F7D6"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                return numberWithCommas(toComma(value.toFixed()));
              },
            },
          },
        });
      }

      //  fin //

      if (monitoreo_id == 25 || monitoreo_id == 27) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [
              data.valores1,
              data.valores2,
              data.valores3,
              data.valores4,
              data.anio,
            ],
            type: "bar",
            groups: [
              [
                "Hidroeléctrica",
                "Nuclear",
                "Renovable no convencional",
                "Distribuida",
              ],
            ],
          },

          bar: {
            width: {
              ratio: 0.3, // this makes bar width 50% of length between ticks
            },
          },

          axis: {
            x: {
              type: "category", // this needed to load string x value
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    return "";
                  }
                  return numberWithCommas(toComma(correctDecimals(d)));
                },
              },
            },
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR"); // devuelve numero sin decimales y con separación de miles
              },
            },
          },
        });
      }

      if (monitoreo_id == 34) {
        $(".ley").css("display", "none");
        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3,
            },
          },

          axis: {
            x: {
              type: "category",
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return d; //numberWithCommas(toComma(correctDecimals(d,data.cantDecimales)));
                  } else {
                    return d; //numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#D177B0"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;
                return value; //numberWithCommas(toComma(txt));
              },
            },
          },
        });
      }
      if (monitoreo_id == 32) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3,
            },
          },

          axis: {
            x: {
              type: "category",
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return d;
                  } else {
                    return d;
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#D177B0"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
      }
      if (monitoreo_id == 33) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3,
            },
          },

          axis: {
            x: {
              type: "category",
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return d;
                  } else {
                    return d;
                  }
                },
              },
            },
          },

          color: {
            pattern: ["#D177B0"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR");
              },
            },
          },
        });
      }
      if (monitoreo_id == 39 || monitoreo_id == 40) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [data.valores, data.anio],
            type: "bar",
          },

          bar: {
            width: {
              ratio: 0.3,
            },
          },

          axis: {
            x: {
              type: "category",
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    return "";
                  }
                  return numberWithCommas(toComma(correctDecimals(d)));
                },
              },
            },
          },

          color: {
            pattern: ["#D177B0"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                return numberWithCommas(toComma(value));
              },
            },
          },
        });
      }
      if (monitoreo_id == 31) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        chart = c3.generate({
          size: {
            height: char_height,
          },

          data: {
            x: "x",
            columns: [
              data.valores1,
              data.valores2,
              data.valores3,
              data.valores4,
              data.valores5,
              data.valores6,
              data.valores7,
              data.valores8,
              data.anio,
            ],
            type: "bar",
            order: null,
          },

          bar: {
            width: {
              ratio: 0.5,
            },
          },

          axis: {
            x: {
              type: "category",
            },
            y: {
              max: data.max,
              padding: { bottom: 0 },
              min: 0,
              tick: {
                format: function (d) {
                  if (d === 0) {
                    return "";
                  }
                  if (data.cantDecimales >= 1) {
                    return numberWithCommas(toComma(correctDecimals(d, 2)));
                  } else {
                    return numberWithCommas(toComma(d));
                  }
                },
              },
            },
          },
          //Falta definir colores.
          color: {
            pattern: [
              "#D177B0",
              "#585961",
              "#E8BBD7",
              "#B3B0B0",
              "#F8EBF3",
              "#EDEDEE",
              "#787FBD",
              "#BBBFDE",
            ],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                return numberWithCommas(toComma(value));
              },
            },
          },
        });
      }

      // Gráfico Anillo No Fósiles - Generación Eléctrica / Capacidad Instalada (2015 -2020)
      if (monitoreo_id == 26 || monitoreo_id == 28) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#unidad_de_medida").show();

        c3.chart.internal.fn.additionalConfig = {
          labelArc: {
            // used to add a second arc outside of the pie arc for the label
            innerRadiusRatio: 0.7,
            outerRadiusRatio: 0.7,
          },
          pieExt: {
            radiusRatio: 0.85, // this is the ratio of the svg area the pie will take up
          },
        };

        /* Calculates a hash for a label coordinates to avaid collisions */

        c3.chart.internal.fn.createHashKey = function (coordinates) {
          return (
            Math.floor(coordinates[0] / 140) * 140 +
            "," +
            Math.floor(coordinates[1] / 24) * 24
          );
        };

        /*
                    Holds hashed value of the label coordinates to try and handle collisions.
                  */
        c3.chart.internal.fn.labelHash = [];

        /*
                    Adding getLabelSvgArc function to implement a second arc for the lables outside of the pie
                  */
        c3.chart.internal.fn.getLabelSvgArc = function () {
          var $$ = this,
            config = $$.api.internal.config;
          var labelarc = $$.d3.svg
            .arc()
            .outerRadius($$.radius * config.labelArc.outerRadiusRatio)
            .innerRadius($$.radius * config.labelArc.innerRadiusRatio);

          var newArc = function (d, withoutUpdate) {
            var updated;
            if (withoutUpdate) {
              return labelarc(d);
            } // for interpolate
            updated = c3.chart.internal.fn.updateAngle(d);
            return updated ? labelarc(updated) : "M 0 0";
          };
          newArc.centroid = labelarc.centroid;
          return newArc;
        };

        c3.chart.internal.fn.updateRadius = function () {
          var $$ = this,
            config = $$.config,
            w = config.gauge_width || config.donut_width;
          $$.radiusExpanded = Math.min($$.arcWidth, $$.arcHeight) / 2;
          $$.radius = $$.radiusExpanded * config.pieExt.radiusRatio;
          $$.innerRadiusRatio = w ? ($$.radius - w) / $$.radius : 0.6;
          $$.innerRadius =
            $$.hasType("donut") || $$.hasType("gauge")
              ? $$.radius * $$.innerRadiusRatio
              : 0;
        };

        c3.chart.internal.fn.updateArc = function () {
          var $$ = this;
          $$.svgArc = $$.getSvgArc();
          $$.labelSvgArc = $$.getLabelSvgArc();
          $$.svgArcExpanded = $$.getSvgArcExpanded();
          $$.svgArcExpandedSub = $$.getSvgArcExpanded(0.98);

          // Draw line from label to midpoint of arc
        };
        if (!$("#chart2").length) {
          $("#chart").after('<div id="chart2"></div>');
          $("#chart2").after('<div id="chart3"></div>');
          $("#chart3").after('<div id="chart4"></div>');
          $("#chart4").after('<div id="chart5"></div>');
          $("#chart5").after('<div id="chart6"></div>');
          $("#chart").css("width", "40%");
          $("#chart").css("display", "inline-block");
          $("#body .content").css("text-align", "center");
          $("#chart_descripcion").css("text-align", "left");
          $("#chart_custom_legend").show();
        }
        // Año 2015
        chart = c3.generate({
          title: {
            show: false,
            text: data.anio[1],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_1_1,
              data.donut_1_2,
              data.donut_1_3,
              data.donut_1_4,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [
              [
                "Hidroeléctrica",
                "Nuclear",
                "Renovable no convencional",
                "Distribuida",
              ],
            ],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_1_1[1] +
                    data.donut_1_2[1] +
                    data.donut_1_3[1] +
                    data.donut_1_4[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR");
              },
            },
          },
        });
        // Año 2016
        second_chart = c3.generate({
          bindto: "#chart2",
          title: {
            show: false,
            text: data.anio[2],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_2_1,
              data.donut_2_2,
              data.donut_2_3,
              data.donut_2_4,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [
              [
                "Hidroeléctrica",
                "Nuclear",
                "Renovable no convencional",
                "Distribuida",
              ],
            ],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_2_1[1] +
                    data.donut_2_2[1] +
                    data.donut_2_3[1] +
                    data.donut_2_4[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
            subtitle: "otro",
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR");
              },
            },
          },
        });
        // Año 2017
        third_chart = c3.generate({
          bindto: "#chart3",
          title: {
            show: false,
            text: data.anio[3],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_3_1,
              data.donut_3_2,
              data.donut_3_3,
              data.donut_3_4,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [
              [
                "Hidroeléctrica",
                "Nuclear",
                "Renovable no convencional",
                "Distribuida",
              ],
            ],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_3_1[1] +
                    data.donut_3_2[1] +
                    data.donut_3_3[1] +
                    data.donut_3_4[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR");
              },
            },
          },

          onrendered: function () {
            d3.selectAll("#chart .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart2 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart3 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart4 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );
          },
        });
        // Año 2018
        fourth_chart = c3.generate({
          bindto: "#chart4",
          title: {
            show: false,
            text: data.anio[4],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_4_1,
              data.donut_4_2,
              data.donut_4_3,
              data.donut_4_4,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [
              [
                "Hidroeléctrica",
                "Nuclear",
                "Renovable no convencional",
                "Distribuida",
              ],
            ],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_4_1[1] +
                    data.donut_4_2[1] +
                    data.donut_4_3[1] +
                    data.donut_4_4[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // value = Math.round(value * 100) / 100;
                // txt = round(value) + " " + data.unidad;
                // return numberWithCommas(toComma(txt));
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR"); // devuelve numero sin decimales y con separación de miles
              },
            },
          },

          onrendered: function () {
            d3.selectAll("#chart .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart2 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart3 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart4 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );
          },
        });

        // Año 2019

        fifth_chart = c3.generate({
          bindto: "#chart5",
          title: {
            show: false,
            text: data.anio[5],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_5_1,
              data.donut_5_2,
              data.donut_5_3,
              data.donut_5_4,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [
              [
                "Hidroeléctrica",
                "Nuclear",
                "Renovable no convencional",
                "Distribuida",
              ],
            ],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_5_1[1] +
                    data.donut_5_2[1] +
                    data.donut_5_3[1] +
                    data.donut_5_4[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // value = Math.round(value * 100) / 100;
                // txt = round(value) + " " + data.unidad;
                // return numberWithCommas(toComma(txt));
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR"); // devuelve numero sin decimales y con separación de miles
              },
            },
          },
        });

        // Año 2020

        sixth_chart = c3.generate({
          bindto: "#chart6",
          title: {
            show: false,
            text: data.anio[6],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_6_1,
              data.donut_6_2,
              data.donut_6_3,
              data.donut_6_4,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [
              [
                "Hidroeléctrica",
                "Nuclear",
                "Renovable no convencional",
                "Distribuida",
              ],
            ],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_6_1[1] +
                    data.donut_6_2[1] +
                    data.donut_6_3[1] +
                    data.donut_6_4[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // value = Math.round(value * 100) / 100;
                // txt = round(value) + " " + data.unidad;
                // return numberWithCommas(toComma(txt));
                if (value % 1 !== 0) {
                  return value.toLocaleString("es-AR", {
                    maximumFractionDigits: 0,
                  });
                }
                return value.toLocaleString("es-AR"); // devuelve numero sin decimales y con separación de miles
              },
            },
          },
        });

        if (!$("#chart_custom_legend .legend").length) {
          d3.select("#chart_custom_legend")
            .insert("div", ":first-child")
            .attr("class", "legend col-md-2")
            .insert("ul")
            .attr("class", "list-group")
            .selectAll("span")
            .data([
              "Hidroeléctrica",
              "Nuclear",
              "Renovable no convencional",
              "Distribuida",
            ])
            .enter()
            .append("li")
            .attr("class", "list-group-item")
            .append("div")
            .attr("class", "legend-label")
            .attr("data-id", function (id) {
              return id;
            })
            .append("div", ".legend-label")
            .html(function (id) {
              var data = chart.data(id);
              return id + "&nbsp&nbsp&nbsp";
            })
            .on("mouseover", function (id) {
              chart.focus(id);
              second_chart.focus(id);
              third_chart.focus(id);
              fourth_chart.focus(id);
              fifth_chart.focus(id);
              sixth_chart.focus(id);
            })
            .on("mouseout", function (id) {
              chart.revert();
              second_chart.revert();
              third_chart.revert();
              fourth_chart.revert();
              fifth_chart.revert();
              sixth_chart.revert();
            })
            .insert("span", ".legend-label")
            .attr("class", "badge")
            .each(function (id) {
              if (id === "Distribuida") {
                d3.select(this).style("background-color", "#B3B0B0");
              } else {
                d3.select(this).style("background-color", chart.color(id));
              }
            })
            .html(function (id) {
              return "&nbsp&nbsp&nbsp&nbsp&nbsp";
            });

          $("#chart_custom_legend .badge").each(function () {
            $(this).insertBefore($(this).parent());
          });

          $("#chart_custom_legend .list-group-item").hover(
            function () {
              $(this)
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            function () {
              $(this)
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .removeClass("c3-target");
            }
          );
        }
      }
      // =============================================
      // Monitoreo 6 y 8 - T15 - todas las fuentes
      if (monitoreo_id == 6 || monitoreo_id == 8) {
        $(".ley").css("display", "block");

        $("#chart_unidad").html(data.unidad);

        $("#chart_anio").html(data.ano);

        $("#unidad_de_medida").show();

        c3.chart.internal.fn.additionalConfig = {
          labelArc: {
            // used to add a second arc outside of the pie arc for the label
            innerRadiusRatio: 0.7,
            outerRadiusRatio: 0.7,
          },
          pieExt: {
            radiusRatio: 0.85, // this is the ratio of the svg area the pie will take up
          },
        };

        /* Calculates a hash for a label coordinates to avaid collisions */

        c3.chart.internal.fn.createHashKey = function (coordinates) {
          return (
            Math.floor(coordinates[0] / 140) * 140 +
            "," +
            Math.floor(coordinates[1] / 24) * 24
          );
        };

        /*
                    Holds hashed value of the label coordinates to try and handle collisions.
                  */
        c3.chart.internal.fn.labelHash = [];

        /*
                    Adding getLabelSvgArc function to implement a second arc for the lables outside of the pie
                  */
        c3.chart.internal.fn.getLabelSvgArc = function () {
          var $$ = this,
            config = $$.api.internal.config;
          var labelarc = $$.d3.svg
            .arc()
            .outerRadius($$.radius * config.labelArc.outerRadiusRatio)
            .innerRadius($$.radius * config.labelArc.innerRadiusRatio);

          var newArc = function (d, withoutUpdate) {
            var updated;
            if (withoutUpdate) {
              return labelarc(d);
            } // for interpolate
            updated = c3.chart.internal.fn.updateAngle(d);
            return updated ? labelarc(updated) : "M 0 0";
          };
          newArc.centroid = labelarc.centroid;
          return newArc;
        };

        c3.chart.internal.fn.updateRadius = function () {
          var $$ = this,
            config = $$.config,
            w = config.gauge_width || config.donut_width;
          $$.radiusExpanded = Math.min($$.arcWidth, $$.arcHeight) / 2;
          $$.radius = $$.radiusExpanded * config.pieExt.radiusRatio;
          $$.innerRadiusRatio = w ? ($$.radius - w) / $$.radius : 0.6;
          $$.innerRadius =
            $$.hasType("donut") || $$.hasType("gauge")
              ? $$.radius * $$.innerRadiusRatio
              : 0;
        };

        c3.chart.internal.fn.updateArc = function () {
          var $$ = this;
          $$.svgArc = $$.getSvgArc();
          $$.labelSvgArc = $$.getLabelSvgArc();
          $$.svgArcExpanded = $$.getSvgArcExpanded();
          $$.svgArcExpandedSub = $$.getSvgArcExpanded(0.98);

          // Draw line from label to midpoint of arc
        };
        if (!$("#chart2").length) {
          $("#chart").after('<div id="chart2"></div>');
          $("#chart2").after('<div id="chart3"></div>');
          $("#chart3").after('<div id="chart4"></div>');
          $("#chart4").after('<div id="chart5"></div>'); // Gráfico nuevo 2019
          $("#chart5").after('<div id="chart6"></div>'); // Gráfico nuevo 2020
          $("#chart").css("width", "40%");
          $("#chart").css("display", "inline-block");
          $("#body .content").css("text-align", "center");
          $("#chart_descripcion").css("text-align", "left");
          $("#chart_custom_legend").show();
        }
        // Graficos anillo - Trancición Energética - todas las fuentes - Generación y Capacidad (2015-2020)
        // Año 2015
        chart = c3.generate({
          title: {
            show: false,
            text: data.anio[1],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_1_1,
              data.donut_1_2,
              data.donut_1_3,
              data.donut_1_4,
              data.donut_1_5,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [["Biogás", "Biomasa", "PAH", "Solar", "Eólica"]],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_1_1[1] +
                    data.donut_1_2[1] +
                    data.donut_1_3[1] +
                    data.donut_1_4[1] +
                    data.donut_1_5[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0", "#FCE4ED"],
          },
          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                //TODO: Revisar funcionamiento
                // value = Math.round(value * 100) / 100;
                if (value % 1 !== 0) {
                  // si tiene decimales , no los muestra y redondea
                  return (
                    value.toLocaleString("es-AR", {
                      maximumFractionDigits: 0,
                    }) +
                    " " +
                    data.unidad
                  );
                }
                return value.toLocaleString("es-AR") + " " + data.unidad;
              },
            },
          },
        });
        // Año 2016
        second_chart = c3.generate({
          bindto: "#chart2",
          title: {
            show: false,
            text: data.anio[2],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_2_1,
              data.donut_2_2,
              data.donut_2_3,
              data.donut_2_4,
              data.donut_2_5,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [["Biogás", "Biomasa", "PAH", "Solar", "Eólica"]],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_2_1[1] +
                    data.donut_2_2[1] +
                    data.donut_2_3[1] +
                    data.donut_2_4[1] +
                    data.donut_2_5[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
            subtitle: "otro",
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0", "#FCE4ED"],
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // TODO: Revisar funcionamiento
                // value = Math.round(value * 100) / 100;
                if (value % 1 !== 0) {
                  // si tiene decimales , no los muestra y redondea
                  return (
                    value.toLocaleString("es-AR", {
                      maximumFractionDigits: 0,
                    }) +
                    " " +
                    data.unidad
                  );
                }
                return value.toLocaleString("es-AR") + " " + data.unidad;
              },
            },
          },
        });
        // Año 2017
        third_chart = c3.generate({
          bindto: "#chart3",
          title: {
            show: false,
            text: data.anio[3],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_3_1,
              data.donut_3_2,
              data.donut_3_3,
              data.donut_3_4,
              data.donut_3_5,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [["Biogás", "Biomasa", "PAH", "Solar", "Eólica"]],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_3_1[1] +
                    data.donut_3_2[1] +
                    data.donut_3_3[1] +
                    data.donut_3_4[1] +
                    data.donut_3_5[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0", "#FCE4ED"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // TODO: Revisar funcionamiento
                // value = Math.round(value * 100) / 100;
                if (value % 1 !== 0) {
                  // si tiene decimales , no los muestra y redondea
                  return (
                    value.toLocaleString("es-AR", {
                      maximumFractionDigits: 0,
                    }) +
                    " " +
                    data.unidad
                  );
                }
                return value.toLocaleString("es-AR") + " " + data.unidad;
              },
            },
          },

          onrendered: function () {
            d3.selectAll("#chart .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart2 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart3 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart4 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );
          },
        });
        // Año 2018
        fourth_chart = c3.generate({
          bindto: "#chart4",
          title: {
            show: false,
            text: data.anio[4],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_4_1,
              data.donut_4_2,
              data.donut_4_3,
              data.donut_4_4,
              data.donut_4_5,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [["Biogás", "Biomasa", "PAH", "Solar", "Eólica"]],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_4_1[1] +
                    data.donut_4_2[1] +
                    data.donut_4_3[1] +
                    data.donut_4_4[1] +
                    data.donut_4_5[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0", "#FCE4ED"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // TODO: Revisar funcionamiento
                if (value % 1 !== 0) {
                  // si tiene decimales , no los muestra y redondea
                  return (
                    value.toLocaleString("es-AR", {
                      maximumFractionDigits: 0,
                    }) +
                    " " +
                    data.unidad
                  );
                }
                return value.toLocaleString("es-AR") + " " + data.unidad;
              },
            },
          },

          onrendered: function () {
            d3.selectAll("#chart .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart2 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart3 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart4 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );
          },
        });
        // Año 2019
        fifth_chart = c3.generate({
          bindto: "#chart5",
          title: {
            show: false,
            text: data.anio[5],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_5_1,
              data.donut_5_2,
              data.donut_5_3,
              data.donut_5_4,
              data.donut_5_5,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [["Biogás", "Biomasa", "PAH", "Solar", "Eólica"]],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_5_1[1] +
                    data.donut_5_2[1] +
                    data.donut_5_3[1] +
                    data.donut_5_4[1] +
                    data.donut_5_5[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0", "#FCE4ED"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // TODO: Revisar funcionamiento
                if (value % 1 !== 0) {
                  // si tiene decimales , no los muestra y redondea
                  return (
                    value.toLocaleString("es-AR", {
                      maximumFractionDigits: 0,
                    }) +
                    " " +
                    data.unidad
                  );
                }
                return value.toLocaleString("es-AR") + " " + data.unidad;
              },
            },
          },

          onrendered: function () {
            d3.selectAll("#chart .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart2 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart3 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart4 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );
          },
        });
        // Año 2020
        sixth_chart = c3.generate({
          bindto: "#chart6",
          title: {
            show: false,
            text: data.anio[6],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 0,
              left: 0,
            },
          },
          size: {
            height: 500,
          },

          data: {
            columns: [
              data.donut_6_1,
              data.donut_6_2,
              data.donut_6_3,
              data.donut_6_4,
              data.donut_6_5,
            ],
            type: "donut",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            groups: [["Biogás", "Biomasa", "PAH", "Solar", "Eólica"]],
            order: null,
          },

          donut: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                var percentFormat = d3.format(",.2%");
                return toComma(percentFormat(ratio));
              },
            },
            title:
              numberWithCommas(
                toComma(
                  (
                    data.donut_6_1[1] +
                    data.donut_6_2[1] +
                    data.donut_6_3[1] +
                    data.donut_6_4[1] +
                    data.donut_6_5[1]
                  ).toFixed(0)
                )
              ) +
              " " +
              data.unidad,
          },

          color: {
            pattern: ["#EE4788", "#585961", "#F6A3C3", "#B3B0B0", "#FCE4ED"],
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                // TODO: Revisar funcionamiento
                if (value % 1 !== 0) {
                  // si tiene decimales , no los muestra y redondea
                  return (
                    value.toLocaleString("es-AR", {
                      maximumFractionDigits: 0,
                    }) +
                    " " +
                    data.unidad
                  );
                }
                return value.toLocaleString("es-AR") + " " + data.unidad;
              },
            },
          },

          onrendered: function () {
            d3.selectAll("#chart .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart2 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart3 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );

            d3.selectAll("#chart4 .c3-chart-arc.c3-target-Solar text").each(
              function (v) {
                var label = d3.select(this);
                var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
                x = pos[0] + 7;
                y = pos[1] - 7;
                pos = [x, y];
                label.attr(
                  "transform",
                  "translate(" + pos[0] + "," + pos[1] + ")"
                );
              }
            );
          },
        });

        // fin seccion de gráficos de anillo por filas

        if (!$("#chart_custom_legend .legend").length) {
          d3.select("#chart_custom_legend")
            .insert("div", ":first-child")
            .attr("class", "legend col-md-2")
            .insert("ul")
            .attr("class", "list-group")
            .selectAll("span")
            .data(["Biogás", "Biomasa", "PAH", "Solar", "Eólica"])
            .enter()
            .append("li")
            .attr("class", "list-group-item")
            .append("div")
            .attr("class", "legend-label")
            .attr("data-id", function (id) {
              return id;
            })
            .append("div", ".legend-label")
            .html(function (id) {
              var data = chart.data(id);
              return id + "&nbsp&nbsp&nbsp";
            })
            .on("mouseover", function (id) {
              chart.focus(id);
              second_chart.focus(id);
              third_chart.focus(id);
              fourth_chart.focus(id);
              fifth_chart.focus(id);
              sixth_chart.focus(id);
            })
            .on("mouseout", function (id) {
              chart.revert();
              second_chart.revert();
              third_chart.revert();
              fourth_chart.revert();
              fifth_chart.revert();
              sixth_chart.revert();
            })
            .insert("span", ".legend-label")
            .attr("class", "badge")
            .each(function (id) {
              d3.select(this).style("background-color", chart.color(id));
            })
            .html(function (id) {
              return "&nbsp&nbsp&nbsp&nbsp&nbsp";
            });

          $("#chart_custom_legend .badge").each(function () {
            $(this).insertBefore($(this).parent());
          });

          $("#chart_custom_legend .list-group-item").hover(
            function () {
              $(this)
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            function () {
              $(this)
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .removeClass("c3-target");
            }
          );
        }
      }

      if (monitoreo_id == 10) {
        $(".ley").css("display", "block"); //TODO:Probar funcionamiento. Son los que muestran en el gráfico la unidad de medida en el título
        $("#chart_unidad").html(data.unidad);
        $("#unidad_de_medida").show();

        c3.chart.internal.fn.additionalConfig = {
          labelArc: {
            // used to add a second arc outside of the pie arc for the label
            innerRadiusRatio: 0.7,
            outerRadiusRatio: 0.7,
          },
          pieExt: {
            radiusRatio: 0.85, // this is the ratio of the svg area the pie will take up
          },
        };

        /* Calculates a hash for a label coordinates to avaid collisions */

        c3.chart.internal.fn.createHashKey = function (coordinates) {
          return (
            Math.floor(coordinates[0] / 140) * 140 +
            "," +
            Math.floor(coordinates[1] / 24) * 24
          );
        };

        /*
                    Holds hashed value of the label coordinates to try and handle collisions.
                  */
        c3.chart.internal.fn.labelHash = [];

        /*
                    Adding getLabelSvgArc function to implement a second arc for the lables outside of the pie
                  */
        c3.chart.internal.fn.getLabelSvgArc = function () {
          var $$ = this,
            config = $$.api.internal.config;
          var labelarc = $$.d3.svg
            .arc()
            .outerRadius($$.radius * config.labelArc.outerRadiusRatio)
            .innerRadius($$.radius * config.labelArc.innerRadiusRatio);

          var newArc = function (d, withoutUpdate) {
            var updated;
            if (withoutUpdate) {
              return labelarc(d);
            } // for interpolate
            updated = c3.chart.internal.fn.updateAngle(d);
            return updated ? labelarc(updated) : "M 0 0";
          };
          newArc.centroid = labelarc.centroid;
          return newArc;
        };

        c3.chart.internal.fn.updateRadius = function () {
          var $$ = this,
            config = $$.config,
            w = config.gauge_width || config.donut_width;
          $$.radiusExpanded = Math.min($$.arcWidth, $$.arcHeight) / 2;
          $$.radius = $$.radiusExpanded * config.pieExt.radiusRatio;
          $$.innerRadiusRatio = w ? ($$.radius - w) / $$.radius : 0.6;
          $$.innerRadius =
            $$.hasType("donut") || $$.hasType("gauge")
              ? $$.radius * $$.innerRadiusRatio
              : 0;
        };

        c3.chart.internal.fn.updateArc = function () {
          var $$ = this;
          $$.svgArc = $$.getSvgArc();
          $$.labelSvgArc = $$.getLabelSvgArc();
          $$.svgArcExpanded = $$.getSvgArcExpanded();
          $$.svgArcExpandedSub = $$.getSvgArcExpanded(0.98);
        };
        // Gráficos anillo - T15 - todas las fuentes -Participación de la generación energética (2015-2020)
        if (!$("#chart2").length) {
          $("#chart").after('<div id="chart2"></div>'); // año 2016
          $("#chart2").after('<div id="chart3"></div>'); // año 2017
          $("#chart3").after('<div id="chart4"></div>'); // año 2018
          $("#chart4").after('<div id="chart5"></div>'); // año 2019
          $("#chart5").after('<div id="chart6"></div>'); // año 2020
          $("#chart").css("width", "40%");
          $("#chart").css("display", "inline-block");
          $("#body .content").css("text-align", "center");
          $("#chart_descripcion").css("text-align", "left");
          $("#chart_custom_legend").show();
        }
        // Año 2015
        chart = c3.generate({
          title: {
            show: false,
            text: data.anio[1],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },

          data: {
            columns: [data.valores1, data.resto1],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          pie: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#585961", "#EE4788"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;
                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
        // Año 2016
        second_chart = c3.generate({
          bindto: "#chart2",
          title: {
            show: false,
            text: data.anio[2],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },

          data: {
            columns: [data.valores2, data.resto2],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          pie: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#585961", "#EE4788"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;
                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
        // Año 2017
        third_chart = c3.generate({
          bindto: "#chart3",
          title: {
            show: false,
            text: data.anio[3],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores3, data.resto3],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#585961", "#EE4788"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });
        // Año 2018
        fourth_chart = c3.generate({
          bindto: "#chart4",
          title: {
            show: false,
            text: data.anio[4],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores4, data.resto4],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#585961", "#EE4788"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });

        // Año 2019
        fifth_chart = c3.generate({
          bindto: "#chart5",
          title: {
            show: false,
            text: data.anio[5],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores5, data.resto5],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#585961", "#EE4788"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });

        // Año 2020
        sixth_chart = c3.generate({
          bindto: "#chart6",
          title: {
            show: false,
            text: data.anio[6],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores6, data.resto6],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#585961", "#EE4788"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              // title: function (d) { return 'Data ' + d; },
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              // pos[0] is x, pos[1] is y. Do some position changes and update value
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });

        if (!$("#chart_custom_legend .legend").length) {
          d3.select("#chart_custom_legend")
            .insert("div", ":first-child")
            .attr("class", "legend col-md-2")
            .insert("ul")
            .attr("class", "list-group")
            .selectAll("span")
            .data(["Participación de la generación de electricidad"])
            .enter()
            .append("li")
            .attr("class", "list-group-item")
            .append("div")
            .attr("class", "legend-label")
            .attr("data-id", function (id) {
              return id;
            })
            .append("div", ".legend-label")
            .html(function (id) {
              var data = chart.data(id);
              return id + "&nbsp&nbsp&nbsp";
            })
            .on("mouseover", function (id) {
              chart.focus(id);
              second_chart.focus(id);
              third_chart.focus(id);
              fourth_chart.focus(id);
              fifth_chart.focus(id);
              sixth_chart.focus(id);
            })
            .on("mouseout", function (id) {
              chart.revert();
              second_chart.revert();
              third_chart.revert();
              fourth_chart.revert();
              fifth_chart.revert();
              sixth_chart.revert();
            })
            .insert("span", ".legend-label")
            .attr("class", "badge")
            .each(function (id) {
              d3.select(this).style("background-color", chart.color(id));
            })
            .html(function (id) {
              return "&nbsp&nbsp&nbsp&nbsp&nbsp";
            });

          $("#chart_custom_legend .badge").each(function () {
            $(this).insertBefore($(this).parent());
          });

          $("#chart_custom_legend .list-group-item").hover(
            function () {
              $(this)
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            function () {
              $(this)
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .removeClass("c3-target");
            }
          );
        }
      }
      if (monitoreo_id == 30) {
        $(".ley").css("display", "block");
        $("#chart_title").html(data.titulo);
        $("#chart_unidad").html(data.unidad);
        $("#unidad_de_medida").show();

        c3.chart.internal.fn.additionalConfig = {
          labelArc: {
            // used to add a second arc outside of the pie arc for the label
            innerRadiusRatio: 0.7,
            outerRadiusRatio: 0.7,
          },
          pieExt: {
            radiusRatio: 0.85, // this is the ratio of the svg area the pie will take up
          },
        };

        /* Calculates a hash for a label coordinates to avaid collisions */

        c3.chart.internal.fn.createHashKey = function (coordinates) {
          return (
            Math.floor(coordinates[0] / 140) * 140 +
            "," +
            Math.floor(coordinates[1] / 24) * 24
          );
        };

        /*
                    Holds hashed value of the label coordinates to try and handle collisions.
                  */
        c3.chart.internal.fn.labelHash = [];

        /*
                    Adding getLabelSvgArc function to implement a second arc for the lables outside of the pie
                  */
        c3.chart.internal.fn.getLabelSvgArc = function () {
          var $$ = this,
            config = $$.api.internal.config;
          var labelarc = $$.d3.svg
            .arc()
            .outerRadius($$.radius * config.labelArc.outerRadiusRatio)
            .innerRadius($$.radius * config.labelArc.innerRadiusRatio);

          var newArc = function (d, withoutUpdate) {
            var updated;
            if (withoutUpdate) {
              return labelarc(d);
            }
            updated = c3.chart.internal.fn.updateAngle(d);
            return updated ? labelarc(updated) : "M 0 0";
          };
          newArc.centroid = labelarc.centroid;
          return newArc;
        };

        c3.chart.internal.fn.updateRadius = function () {
          var $$ = this,
            config = $$.config,
            w = config.gauge_width || config.donut_width;
          $$.radiusExpanded = Math.min($$.arcWidth, $$.arcHeight) / 2;
          $$.radius = $$.radiusExpanded * config.pieExt.radiusRatio;
          $$.innerRadiusRatio = w ? ($$.radius - w) / $$.radius : 0.6;
          $$.innerRadius =
            $$.hasType("donut") || $$.hasType("gauge")
              ? $$.radius * $$.innerRadiusRatio
              : 0;
        };

        c3.chart.internal.fn.updateArc = function () {
          var $$ = this;
          $$.svgArc = $$.getSvgArc();
          $$.labelSvgArc = $$.getLabelSvgArc();
          $$.svgArcExpanded = $$.getSvgArcExpanded();
          $$.svgArcExpandedSub = $$.getSvgArcExpanded(0.98);
        };

        // Gráficos de torta Energía - No Fósiles - Participación de la generación (2015 - 2020)
        if (!$("#chart2").length) {
          $("#chart").after('<div id="chart2"></div>');
          $("#chart2").after('<div id="chart3"></div>');
          $("#chart3").after('<div id="chart4"></div>');
          $("#chart4").after('<div id="chart5"></div>');
          $("#chart5").after('<div id="chart6"></div>');
          $("#chart").css("width", "40%");
          $("#chart").css("display", "inline-block");
          $("#body .content").css("text-align", "center");
          $("#chart_descripcion").css("text-align", "left");
          $("#chart_custom_legend").show();
        }
        // Año 2015
        chart = c3.generate({
          title: {
            show: false,
            text: data.anio[1],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },

          data: {
            columns: [data.valores1, data.resto1],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          pie: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#EE4788", "#585961"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
        // Año 2016
        second_chart = c3.generate({
          bindto: "#chart2",
          title: {
            show: false,
            text: data.anio[2],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },

          data: {
            columns: [data.valores2, data.resto2],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          pie: {
            label: {
              threshold: 0.001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          color: {
            pattern: ["#EE4788", "#585961"],
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },
        });
        // Año 2017
        third_chart = c3.generate({
          bindto: "#chart3",
          title: {
            show: false,
            text: data.anio[3],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores3, data.resto3],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#EE4788", "#585961"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });
        // año 2018
        fourth_chart = c3.generate({
          bindto: "#chart4",
          title: {
            show: false,
            text: data.anio[4],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores4, data.resto4],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#EE4788", "#585961"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });

        // Año 2019
        fifth_chart = c3.generate({
          bindto: "#chart5",
          title: {
            show: false,
            text: data.anio[5],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores5, data.resto5],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#EE4788", "#585961"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });

        // Año 2020
        sixth_chart = c3.generate({
          bindto: "#chart6",
          title: {
            show: false,
            text: data.anio[6],
            position: "top-center",
            padding: {
              top: 0,
              right: 0,
              bottom: 20,
              left: 0,
            },
          },
          size: {
            height: 400,
          },
          data: {
            columns: [data.valores6, data.resto6],
            type: "pie",
            onmouseover: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            onmouseout: function (d) {
              $('.legend-label[data-id="' + d.id + '"]')
                .parent()
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .addClass("c3-target");
            },
            order: null,
          },

          color: {
            pattern: ["#EE4788", "#585961"],
          },

          pie: {
            label: {
              show: true,
              threshold: 0.0001,
              format: function (value, ratio, id) {
                return (
                  numberWithCommas(
                    toComma(correctDecimals(value, data.cantDecimales))
                  ) + "%"
                );
              },
            },
          },

          legend: {
            show: false,
          },

          tooltip: {
            format: {
              value: function (value, ratio, id) {
                value = Math.round(value * 100) / 100;

                txt = round(value) + " " + data.unidad;

                return numberWithCommas(toComma(txt));
              },
            },
          },

          onrendered: function () {
            d3.selectAll(
              ".c3-chart-arc.c3-target-Participación-de-la-generación-renovable-no-convencional text"
            ).each(function (v) {
              var label = d3.select(this);
              var pos = label.attr("transform").match(/-?\d+(\.\d+)?/g);
              pos = [12, -160];
              label.attr(
                "transform",
                "translate(" + pos[0] + "," + pos[1] + ") rotate(3)"
              );
              label.style({ fill: "black", "font-size": "13px" });
            });

            d3.selectAll(
              ".c3-chart-arc.c3-target-Resto-de-generación-de-electricidad text"
            ).each(function (v) {
              var label = d3.select(this);
              label.remove();
            });

            d3.selectAll(".c3-chart-arc").attr("transform", "rotate(-3)");
          },
        });

        if (!$("#chart_custom_legend .legend").length) {
          d3.select("#chart_custom_legend")
            .insert("div", ":first-child")
            .attr("class", "legend col-md-2")
            .insert("ul")
            .attr("class", "list-group")
            .selectAll("span")
            .data(["Participación de la generación de electricidad"])
            .enter()
            .append("li")
            .attr("class", "list-group-item")
            .append("div")
            .attr("class", "legend-label")
            .attr("data-id", function (id) {
              return id;
            })
            .append("div", ".legend-label")
            .html(function (id) {
              var data = chart.data(id);
              return id + "&nbsp&nbsp&nbsp";
            })
            .on("mouseover", function (id) {
              chart.focus(id);
              second_chart.focus(id);
              third_chart.focus(id);
              fourth_chart.focus(id);
              fifth_chart.focus(id);
              sixth_chart.focus(id);
            })
            .on("mouseout", function (id) {
              chart.revert();
              second_chart.revert();
              third_chart.revert();
              fourth_chart.revert();
              fifth_chart.revert();
              sixth_chart.revert();
            })
            .insert("span", ".legend-label")
            .attr("class", "badge")
            .each(function (id) {
              d3.select(this).style("background-color", chart.color(id));
            })
            .html(function (id) {
              return "&nbsp&nbsp&nbsp&nbsp&nbsp";
            });

          $("#chart_custom_legend .badge").each(function () {
            $(this).insertBefore($(this).parent());
          });

          $("#chart_custom_legend .list-group-item").hover(
            function () {
              $(this)
                .siblings(".list-group-item")
                .addClass("c3-defocused")
                .addClass("c3-target");
            },
            function () {
              $(this)
                .siblings(".list-group-item")
                .removeClass("c3-defocused")
                .removeClass("c3-target");
            }
          );
        }
      }
    });
  }
}
